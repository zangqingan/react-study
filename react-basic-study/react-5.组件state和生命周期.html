<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>5.组件state和生命周期</title>
</head>
<body>
  <div id="app">
    
  </div>
  <hr>
  <div>
    <h4>1.组件state(组件状态)</h4>
    <pre>
      1.概述
        State 与 props 类似,但是 state 是私有的,并且完全受控于当前组件。简单说使用它就可以实现状态的改变页面同步刷新。

      2.使用方法

        函数组件: 使用是很简单的、通过执行钩子函数 useState() 即可获取到一个state状态变量。
          import { useState } from 'react' 引入钩子函数
        在使用时接受一个初始值参数、
          const result = useState(1)
          解构
          const [age,setAge] = useAge(1)
        返回一个数组
          第一个元素就是初始值、
          第二个元素是一个函数通常命名为 setXXX、它是用来修改state的、调用它就会修改state进而会触发组件的重新渲染。
          只有当值变化不一样了才会发生重新渲染。当state是一个对象时修改是整个替换。
          它也可以接受一个回调函数、回调函数会接受上一次的state作为参数
        跟vue类似,不要直接修改state而是使用 this.setState() 方法来动态更新组件 state。
        组件可以选择把它的 state 作为 props 向下传递到它的子组件中这就形成了父子组件通信的单向数据流。
    </p>
    <h4>2.组件的生命周期</h4>
    <pre>
      组件第一次被渲染到 DOM 中的时候,这在 React 中被称为“挂载(mount)”。
      当 DOM 中 组件被删除的时候,这在 React 中被称为“卸载(unmount)”。
      这时,当组件挂载或卸载时就可以执行一些特点方法。跟vue的生命周期钩子类似本质上就是一个函数API,这些方法也叫做“生命周期方法”。
      componentDidMount() {},组件第一次渲染完成,此时dom节点已经生成,可以在这里调用ajax请求,返回数据setState后组件会重新渲染,这个就相当于vue的mounted阶段。
      componentWillUnmount() {},在此处完成组件的卸载和数据的销毁。
      这个相当于vue中的beforeDestory、清除你在组件中所有的setTimeout,setInterval、移除所有组建中的监听 removeEventListener。

    </p>
  </div>

  <!-- js -->
  <script src="./js/react.development.js" ></script>  
  <script src="./js/react-dom.development.js" ></script>
  <script src="./js/babel.min.js"></script>
  <script type="text/babel">
    // React.useState(0)
    class Name extends React.Component{
      /*
        state是通过构造函数传参的形式传入的

      */
      constructor(props){
        super(props)
        this.state = {date: new Date()};
      }
      render(){
        return (
          <div>
            <h1>hello {this.props.name}{this.props.age}</h1>
            <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
          </div>
        )
      }

    }
    const user = {
      name:'lisi',
      age:22
    }
    //类似vue中的el选项
    const root = ReactDOM.createRoot(document.getElementById('app'))
    root.render( 
      <Name name={user.name} age={user.age}/>,//类似vue中的template
    )
  </script>

</body>
</html>