{"diagram":{"image":{"x":0,"width":200,"y":0,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","height":200},"elements":{"leftChildren":[],"note":"","margin":{"childMarginW":10,"childMarginH":5,"marginW":20,"marginH":10},"watermark":"","children":[{"parent":"root","lineStyle":{"randomLineColor":"rgb(255,204,204)","lineColor":"#7B1FA2"},"children":[{"parent":"812b3a9306dd","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"75f8599ad22f","title":"Refs&nbsp;提供了一种方式，允许我们访问&nbsp;DOM&nbsp;节点或在&nbsp;render&nbsp;方法中创建的&nbsp;React&nbsp;元素","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"812b3a9306dd","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"0ef2dcae2dae","title":"在典型的&nbsp;React&nbsp;数据流中，props&nbsp;是父组件与子组件交互的唯一方式。要修改一个子组件，你需要使用新的&nbsp;props&nbsp;来重新渲染它。<br>但是，在某些情况下，你需要在典型数据流之外强制修改子组件。被修改的子组件可能是一个&nbsp;React&nbsp;组件的实例，也可能是一个&nbsp;DOM&nbsp;元素。对于这两种情况，React&nbsp;都提供了解决办法","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"background-color":"#7B1FA2","border-radius":"5px","color":"rgb(255, 255, 255)","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"812b3a9306dd","title":"简述"},{"parent":"root","lineStyle":{"lineColor":"#1976D2"},"children":[{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"1d57845dec4f","title":"管理焦点，文本选择或媒体播放","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"0f616bb19aaa","title":"触发强制动画","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"bb89bb98dcf2","title":"集成第三方&nbsp;DOM&nbsp;库","icons":[{"color":"rgb(255, 159, 26)","name":"priority","index":"2","text":"&#xe62a"}]},{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"b2a4794968fd","title":"注意：避免使用&nbsp;refs&nbsp;来做任何可以通过声明式实现来完成的事情","icons":[{"color":"rgb(48, 191, 191)","name":"priority","index":"3","text":"&#xe635"}]}],"style":{"background-color":"#1976D2","border-radius":"5px","font-weight":"bold","font-size":13},"id":"3b7f7da9d693","title":"何时使用&nbsp;Refs"},{"parent":"root","lineStyle":{"lineColor":"#388E3C","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"children":[{"parent":"0291282e6d37","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"0e25a6a0a3ce","title":"你可能首先会想到使用&nbsp;refs&nbsp;在你的&nbsp;app&nbsp;中“让事情发生”。如果是这种情况，请花一点时间，认真再考虑一下&nbsp;state&nbsp;属性应该被安排在哪个组件层中。<br>通常你会想明白，让更高的组件层级拥有这个&nbsp;state，是更恰当的","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"rgb(255, 255, 255)","textAlign":"left","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","font-style":"normal","border-radius":"5px","background-color":"#388E3C","lineStype":{"lineColor":"#388E3C","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#388E3C","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"font-family":"微软雅黑","border-width":"0px","border-style":"none"},"id":"0291282e6d37","title":"勿过度使用&nbsp;Refs<br>"},{"parent":"root","lineStyle":{"randomLineColor":"rgb(153,204,255)","lineColor":"#F57F17"},"children":[{"parent":"b653f7534587","note":"class MyComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.myRef = React.createRef();\n  }\n  render() {\n    return &lt;div ref={this.myRef} /&gt;;\n  }\n}","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"4e45887e5c5d","title":"Refs&nbsp;是使用&nbsp;React.createRef()&nbsp;创建的，并通过&nbsp;ref&nbsp;属性附加到&nbsp;React&nbsp;元素。在构造组件时，通常将&nbsp;Refs&nbsp;分配给实例属性，以便可以在整个组件中引用它们","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"b653f7534587","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"464cdf10b55a","title":"注意，React.createRef()&nbsp;API是在&nbsp;React&nbsp;16.3&nbsp;版本引入的，如果你正在使用一个较早版本的&nbsp;React，我们推荐你使用回调形式的&nbsp;refs<br>","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"background-color":"#F57F17","border-radius":"5px","color":"rgb(255, 255, 255)","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"b653f7534587","title":"创建&nbsp;Refs"},{"parent":"root","lineStyle":{"lineColor":"#E57373","lineWidth":"2"},"children":[{"parent":"2c0b8a719934","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"2851bd9e62f4","children":[],"id":"06c01b64bc99","title":"const&nbsp;node&nbsp;=&nbsp;this.myRef.current;"}],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"2851bd9e62f4","title":"当&nbsp;ref&nbsp;被传递给&nbsp;render&nbsp;中的元素时，对该节点的引用可以在&nbsp;ref&nbsp;的&nbsp;current&nbsp;属性中被访问","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"2c0b8a719934","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"cc5a0cace182","children":[],"id":"c7a4b2c221bd","title":"当&nbsp;ref&nbsp;属性用于&nbsp;HTML&nbsp;元素时，构造函数中使用&nbsp;React.createRef()&nbsp;创建的&nbsp;ref&nbsp;接收底层&nbsp;DOM&nbsp;元素作为其&nbsp;current&nbsp;属性。"},{"parent":"cc5a0cace182","children":[],"id":"4c85d3d7ea70","title":"当&nbsp;ref&nbsp;属性用于自定义&nbsp;class&nbsp;组件时，ref&nbsp;对象接收组件的挂载实例作为其&nbsp;current&nbsp;属性。"},{"parent":"cc5a0cace182","children":[],"id":"1c2344121a31","title":"你不能在函数组件上使用&nbsp;ref&nbsp;属性，因为他们没有实例"}],"style":{"padding":"2px 8px 2px 8px","color":"rgb(33, 39, 61)","textAlign":"left","font-weight":"normal","font-size":"13px","border-color":"rgb(33, 39, 61)","bold":false,"font-style":"normal","italic":false,"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"background-color":"rgb(200, 212, 230)","border-radius":"20px","lineStyle":{"lineColor":"#555","lineWidth":1},"font-family":"微软雅黑","border-width":"0px","border-style":"none"},"id":"cc5a0cace182","title":"ref&nbsp;的值<br>根据节点的类型<br>而有所不同","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#F5F5F5","textAlign":"left","font-weight":"bold","font-size":13,"font-style":"normal","border-radius":"5px","background-color":"#E57373","lineStype":{"lineColor":"#E57373","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#E57373","lineWidth":"2"},"font-family":"微软雅黑","border-width":0,"border-style":"solid"},"id":"2c0b8a719934","title":"访问&nbsp;Refs"},{"parent":"root","lineStyle":{"lineColor":"#1976D2","lineWidth":"2"},"children":[{"parent":"f9685be6a938","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"0abe25f2a285","title":"在极少数情况下，你可能希望在父组件中引用子节点的&nbsp;DOM&nbsp;节点。<br>通常不建议这样做，因为它会打破组件的封装，但它偶尔可用于触发焦点或测量子&nbsp;DOM&nbsp;节点的大小或位置。<br>虽然你可以向子组件添加&nbsp;ref，但这不是一个理想的解决方案，因为你只能获取组件实例而不是&nbsp;DOM&nbsp;节点。并且，它还在函数组件上无效","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"f9685be6a938","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"3cbbd750fec2","title":"如果你使用&nbsp;16.3&nbsp;或更高版本的&nbsp;React,&nbsp;这种情况下我们推荐使用&nbsp;ref&nbsp;转发。Ref&nbsp;转发使组件可以像暴露自己的&nbsp;ref&nbsp;一样暴露子组件的&nbsp;ref<br>如果你使用&nbsp;16.2&nbsp;或更低版本的&nbsp;React，或者你需要比&nbsp;ref&nbsp;转发更高的灵活性，你可以使用这个替代方案将&nbsp;ref&nbsp;作为特殊名字的&nbsp;prop&nbsp;直接传递<br>","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"f9685be6a938","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"145da10da199","title":"可能的话，我们不建议暴露&nbsp;DOM&nbsp;节点，但有时候它会成为救命稻草。注意这个方案需要你在子组件中增加一些代码。如果你对子组件的实现没有控制权的话，你剩下的选择是使用&nbsp;findDOMNode()，但在严格模式&nbsp;下已被废弃且不推荐使用","icons":[{"color":"rgb(255, 159, 26)","name":"priority","index":"2","text":"&#xe62a"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#F5F5F5","textAlign":"left","font-weight":"bold","font-size":13,"font-style":"normal","border-radius":"5px","background-color":"#1976D2","lineStype":{"lineColor":"#1976D2","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#1976D2","lineWidth":"2"},"font-family":"微软雅黑","border-width":0,"border-style":"solid"},"id":"f9685be6a938","title":"将&nbsp;DOM&nbsp;Refs&nbsp;暴露给父组件"},{"parent":"root","lineStyle":{"lineColor":"#7B1FA2","randomLineColor":"rgb(255,204,204)","lineWidth":"2"},"children":[{"parent":"ac506b5380d3","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"40016e60c201","title":"React&nbsp;也支持另一种设置&nbsp;refs&nbsp;的方式，称为“回调&nbsp;refs”。它能助你更精细地控制何时&nbsp;refs&nbsp;被设置和解除","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"ac506b5380d3","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"e4eb47759d85","title":"不同于传递&nbsp;createRef()&nbsp;创建的&nbsp;ref&nbsp;属性，你会传递一个函数。<br>这个函数中接受&nbsp;React&nbsp;组件实例或&nbsp;HTML&nbsp;DOM&nbsp;元素作为参数，以使它们能在其他地方被存储和访问","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"ac506b5380d3","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"2aaff084b81f","children":[],"id":"ca448fedc6f5","title":"如果&nbsp;ref&nbsp;回调函数是以内联函数的方式定义的，在更新过程中它会被执行两次，第一次传入参数&nbsp;null，然后第二次会传入参数&nbsp;DOM&nbsp;元素。<br>这是因为在每次渲染时会创建一个新的函数实例，所以&nbsp;React&nbsp;清空旧的&nbsp;ref&nbsp;并且设置新的。<br>通过将&nbsp;ref&nbsp;的回调函数定义成&nbsp;class&nbsp;的绑定函数的方式可以避免上述问题，但是大多数情况下它是无关紧要的"}],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"2aaff084b81f","title":"说明","icons":[{"color":"rgb(255, 159, 26)","name":"priority","index":"2","text":"&#xe62a"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"rgb(255, 255, 255)","textAlign":"left","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","font-style":"normal","border-radius":"5px","background-color":"#7B1FA2","lineStype":{"lineColor":"#7B1FA2","randomLineColor":"rgb(255,204,204)","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#7B1FA2","randomLineColor":"rgb(255,204,204)","lineWidth":"2"},"font-family":"微软雅黑","border-width":"0px","border-style":"none"},"id":"ac506b5380d3","title":"回调&nbsp;Refs"},{"parent":"root","children":[{"parent":"11abe8d92e57","children":[],"id":"11f83638a9f1","title":"如果你之前使用过&nbsp;React，你可能了解过之前的&nbsp;API&nbsp;中的&nbsp;string&nbsp;类型的&nbsp;ref&nbsp;属性，例如&nbsp;\"textInput\"。你可以通过&nbsp;this.refs.textInput&nbsp;来访问&nbsp;DOM&nbsp;节点。我们不建议使用它，因为&nbsp;string&nbsp;类型的&nbsp;refs&nbsp;存在&nbsp;一些问题。它已过时并可能会在未来的版本被移除"},{"parent":"11abe8d92e57","children":[],"id":"d74f5104fe73","title":"如果你目前还在使用&nbsp;this.refs.textInput&nbsp;这种方式访问&nbsp;refs&nbsp;，我们建议用回调函数或&nbsp;createRef&nbsp;API&nbsp;的方式代替"}],"style":{"font-weight":"bold"},"id":"11abe8d92e57","title":"过时&nbsp;API：String&nbsp;类型的&nbsp;Refs"}],"root":true,"theme":"customise_7fd055efa78b","style":{"background-color":"rgb(80, 194, 139)","border-radius":"5px","color":"rgb(255, 255, 255)","font-weight":"bold","border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"root","title":"Refs&nbsp;&amp;&nbsp;DOM<br>","icons":[{"color":"rgb(255, 255, 255)","name":"","index":"52"}],"structure":"mind_free"}},"meta":{"exportTime":"2022-04-08 17:48:49","member":"60cca488e0b34d55bbf2954f","diagramInfo":{"creator":"60cca488e0b34d55bbf2954f","created":"2022-04-08 17:30:14","modified":"2022-04-08 17:48:38","title":"3.16Refs & DOM","category":"mind_free"},"id":"625000a61e085332f33487b4","type":"ProcessOn Schema File","version":"1.0"}}