{"diagram":{"image":{"x":0,"width":200,"y":0,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","height":200},"elements":{"leftChildren":[],"note":"","margin":{"childMarginW":10,"childMarginH":5,"marginW":20,"marginH":10},"watermark":"","children":[{"parent":"root","lineStyle":{"randomLineColor":"rgb(255,204,204)","lineColor":"#E57373"},"children":[{"parent":"812b3a9306dd","note":"","children":[],"style":{"font-weight":"normal"},"id":"ac25a09c6779","title":"Profiler&nbsp;测量渲染一个&nbsp;React&nbsp;应用多久渲染一次以及渲染一次的“代价”","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"812b3a9306dd","note":"","children":[],"style":{"font-weight":"normal"},"id":"4d70d73dad33","title":"它的目的是识别出应用中渲染较慢的部分，或是可以使用类似&nbsp;memoization&nbsp;优化的部分，并从相关优化中获益","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"812b3a9306dd","children":[{"parent":"3ce2e9e4fcdf","children":[],"id":"469a9ec8704f","title":"Profiling&nbsp;增加了额外的开支，所以它在生产构建中会被禁用"},{"parent":"3ce2e9e4fcdf","children":[],"id":"640d500c6bdd","title":"为了将&nbsp;profiling&nbsp;功能加入生产环境中，React&nbsp;提供了使&nbsp;profiling&nbsp;可用的特殊的生产构建环境。&nbsp;<br>可以从&nbsp;fb.me/react-profiling了解更多关于如何使用这个构建环境的信息"}],"style":{"font-weight":"normal"},"id":"3ce2e9e4fcdf","title":"注意","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"2","text":"&#xe62a"}]}],"style":{"background-color":"#E57373","border-radius":"5px","color":"#000000","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"812b3a9306dd","title":"简介"},{"parent":"root","lineStyle":{"lineColor":"#FFE0B2"},"children":[{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"3da828dbd224","title":"Profiler&nbsp;能添加在&nbsp;React&nbsp;树中的任何地方来测量树中这部分渲染所带来的开销。","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"4d0baeac4530","children":[],"id":"328476c0a44c","title":"一个是&nbsp;id(string)"},{"parent":"4d0baeac4530","children":[],"id":"639c8be6065e","title":"一个是当组件树中的组件“提交”更新的时候被React调用的回调函数&nbsp;onRender(function)"}],"boundaries":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"4d0baeac4530","title":"它需要两个&nbsp;prop","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"3b7f7da9d693","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"6c79dfddc125","children":[{"parent":"9525075b6be8","note":"render(\n  &lt;App&gt;\n    &lt;Profiler id=&quot;Navigation&quot; onRender={callback}&gt;\n      &lt;Navigation {...props} /&gt;\n    &lt;/Profiler&gt;\n    &lt;Main {...props} /&gt;\n  &lt;/App&gt;\n);","children":[],"id":"0111228e1e59","title":"代码"}],"id":"9525075b6be8","title":"为了分析&nbsp;Navigation&nbsp;组件和它的子代"}],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"6c79dfddc125","title":"举例","icons":[{"color":"rgb(255, 159, 26)","name":"priority","index":"2","text":"&#xe62a"}]},{"parent":"3b7f7da9d693","note":"render(\n  &lt;App&gt;\n    &lt;Profiler id=&quot;Navigation&quot; onRender={callback}&gt;\n      &lt;Navigation {...props} /&gt;\n    &lt;/Profiler&gt;\n    &lt;Profiler id=&quot;Main&quot; onRender={callback}&gt;\n      &lt;Main {...props} /&gt;\n    &lt;/Profiler&gt;\n  &lt;/App&gt;\n);","children":[],"id":"20b0ffda7af5","title":"多个&nbsp;Profiler&nbsp;组件能测量应用中的不同部分","icons":[{"color":"rgb(48, 191, 191)","name":"priority","index":"3"}]},{"parent":"3b7f7da9d693","note":"render(\n  &lt;App&gt;\n    &lt;Profiler id=&quot;Panel&quot; onRender={callback}&gt;\n      &lt;Panel {...props}&gt;\n        &lt;Profiler id=&quot;Content&quot; onRender={callback}&gt;\n          &lt;Content {...props} /&gt;\n        &lt;/Profiler&gt;\n        &lt;Profiler id=&quot;PreviewPane&quot; onRender={callback}&gt;\n          &lt;PreviewPane {...props} /&gt;\n        &lt;/Profiler&gt;\n      &lt;/Panel&gt;\n    &lt;/Profiler&gt;\n  &lt;/App&gt;\n);","children":[],"id":"308445b37887","title":"嵌套使用&nbsp;Profiler&nbsp;组件来测量相同一个子树下的不同组件","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"4"}]},{"parent":"3b7f7da9d693","children":[{"parent":"db5b00cc02d2","children":[],"id":"93b278cc7a2f","title":"尽管&nbsp;Profiler&nbsp;是一个轻量级组件，我们依然应该在需要时才去使用它。对一个应用来说，每添加一些都会给&nbsp;CPU&nbsp;和内存带来一些负担"}],"id":"db5b00cc02d2","title":"注意"}],"boundaries":[],"style":{"background-color":"#FFE0B2","border-radius":"5px","color":"#000000","font-weight":"bold","font-size":13},"id":"3b7f7da9d693","title":"用法"},{"parent":"root","lineStyle":{"randomLineColor":"rgb(153,204,255)","lineColor":"#F57F17"},"children":[{"parent":"b653f7534587","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"09c359863911","title":"Profiler&nbsp;需要一个&nbsp;onRender&nbsp;函数作为参数。&nbsp;React&nbsp;会在&nbsp;profile&nbsp;包含的组件树中任何组件&nbsp;“提交”&nbsp;一个更新的时候调用这个函数。&nbsp;<br>它的参数描述了渲染了什么和花费了多久","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"b653f7534587","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"a055a844090f","children":[],"style":{"background-color":"#F5F5F5","font-size":12},"id":"8f9dbbd60c48","title":"function&nbsp;onRenderCallback(<br>&nbsp;&nbsp;id,&nbsp;//&nbsp;发生提交的&nbsp;Profiler&nbsp;树的&nbsp;“id”<br>&nbsp;&nbsp;phase,&nbsp;//&nbsp;\"mount\"&nbsp;（如果组件树刚加载）&nbsp;或者&nbsp;\"update\"&nbsp;（如果它重渲染了）之一<br>&nbsp;&nbsp;actualDuration,&nbsp;//&nbsp;本次更新&nbsp;committed&nbsp;花费的渲染时间<br>&nbsp;&nbsp;baseDuration,&nbsp;//&nbsp;估计不使用&nbsp;memoization&nbsp;的情况下渲染整颗子树需要的时间<br>&nbsp;&nbsp;startTime,&nbsp;//&nbsp;本次更新中&nbsp;React&nbsp;开始渲染的时间<br>&nbsp;&nbsp;commitTime,&nbsp;//&nbsp;本次更新中&nbsp;React&nbsp;committed&nbsp;的时间<br>&nbsp;&nbsp;interactions&nbsp;//&nbsp;属于本次更新的&nbsp;interactions&nbsp;的集合<br>)&nbsp;{<br>&nbsp;&nbsp;//&nbsp;合计或记录渲染时间。。。<br>}"}],"boundaries":[{"boundary":true,"parent":"a055a844090f","boundRank":1,"children":[],"range":"0,0","style":{"lineType":"1","dasharray":"6,3","lineColor":"#63abf7","fill":"#63abf7","opacity":"0.1","lineWidth":"1"},"id":"fe47754792d2","title":"外框"}],"style":{"lineStype":{"lineType":"curve","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"a055a844090f","title":"如","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"b653f7534587","children":[{"parent":"102f26cbd6c3","children":[],"id":"5b5230eb5309","title":"id:&nbsp;string&nbsp;-&nbsp;发生提交的&nbsp;Profiler&nbsp;树的&nbsp;id。&nbsp;如果有多个&nbsp;profiler，它能用来分辨树的哪一部分发生了“提交”。"},{"parent":"102f26cbd6c3","children":[],"id":"73484ebee697","title":"phase:&nbsp;\"mount\"&nbsp;|&nbsp;\"update\"&nbsp;-&nbsp;判断是组件树的第一次装载引起的重渲染，还是由&nbsp;props、state&nbsp;或是&nbsp;hooks&nbsp;改变引起的重渲染。"},{"parent":"102f26cbd6c3","children":[],"id":"b43db9cf56f3","title":"actualDuration:&nbsp;number&nbsp;-&nbsp;本次更新在渲染&nbsp;Profiler&nbsp;和它的子代上花费的时间。&nbsp;这个数值表明使用&nbsp;memoization&nbsp;之后能表现得多好。（例如&nbsp;React.memo，useMemo，shouldComponentUpdate）。&nbsp;理想情况下，由于子代只会因特定的&nbsp;prop&nbsp;改变而重渲染，因此这个值应该在第一次装载之后显著下降。"},{"parent":"102f26cbd6c3","children":[],"id":"8637ccf349e0","title":"baseDuration:&nbsp;number&nbsp;-&nbsp;在&nbsp;Profiler&nbsp;树中最近一次每一个组件&nbsp;render&nbsp;的持续时间。&nbsp;这个值估计了最差的渲染时间。（例如当它是第一次加载或者组件树没有使用&nbsp;memoization）。"},{"parent":"102f26cbd6c3","children":[],"id":"36380e739ef4","title":"startTime:&nbsp;number&nbsp;-&nbsp;本次更新中&nbsp;React&nbsp;开始渲染的时间戳。"},{"parent":"102f26cbd6c3","children":[],"id":"e462ccb519ac","title":"commitTime:&nbsp;number&nbsp;-&nbsp;本次更新中&nbsp;React&nbsp;commit&nbsp;阶段结束的时间戳。&nbsp;在一次&nbsp;commit&nbsp;中这个值在所有的&nbsp;profiler&nbsp;之间是共享的，可以将它们按需分组。"},{"parent":"102f26cbd6c3","children":[],"id":"9467569a9c2c","title":"interactions:&nbsp;Set&nbsp;-&nbsp;当更新被制定时，“interactions”&nbsp;的集合会被追踪。（例如当&nbsp;render&nbsp;或者&nbsp;setState&nbsp;被调用时）。"}],"id":"102f26cbd6c3","title":"参数说明"}],"style":{"background-color":"#F57F17","border-radius":"5px","color":"#000000","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"b653f7534587","title":"onRender&nbsp;回调"}],"root":true,"theme":"customise_7fd055efa78b","style":{"background-color":"rgb(255, 83, 92)","border-radius":"6px","color":"rgb(255, 255, 255)","font-weight":"bold","border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"root","title":"Profiler&nbsp;API","icons":[{"color":"rgb(255, 255, 255)","name":"","index":"53","text":"&#xe693"}],"structure":"mind_free"}},"meta":{"exportTime":"2022-04-08 09:29:44","member":"60cca488e0b34d55bbf2954f","diagramInfo":{"creator":"60cca488e0b34d55bbf2954f","created":"2022-04-08 09:10:32","modified":"2022-04-08 09:29:20","title":"3.12Profiler API","category":"mind_free"},"id":"624f8b881e085332f332431b","type":"ProcessOn Schema File","version":"1.0"}}