{"diagram":{"image":{"x":0,"width":200,"y":0,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","height":200},"elements":{"leftChildren":[],"note":"","watermark":"","children":[{"parent":"root","lineStyle":{"lineColor":"#BBDEFB"},"children":[{"parent":"812b3a9306dd","children":[],"id":"2492c0c9f421","title":"const&nbsp;MyContext&nbsp;=&nbsp;React.createContext(defaultValue);"},{"parent":"812b3a9306dd","note":"","children":[],"id":"ac25a09c6779","title":"用于创建一个&nbsp;Context&nbsp;对象。<br>当&nbsp;React&nbsp;渲染一个订阅了这个&nbsp;Context&nbsp;对象的组件，这个组件会从组件树中离自身最近的那个匹配的&nbsp;Provider&nbsp;中读取到当前的&nbsp;context&nbsp;值<br>","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"812b3a9306dd","children":[],"id":"4d70d73dad33","title":"只有当组件所处的树中没有匹配到&nbsp;Provider&nbsp;时，其&nbsp;defaultValue&nbsp;参数才会生效。这有助于在不使用&nbsp;Provider&nbsp;包装组件的情况下对组件进行测试。<br>注意：将&nbsp;undefined&nbsp;传递给&nbsp;Provider&nbsp;的&nbsp;value&nbsp;时，消费组件的&nbsp;defaultValue&nbsp;不会生效<br>","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"background-color":"#BBDEFB","border-radius":"5px","color":"#0D47A1","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"812b3a9306dd","title":"React.createContext<br>"},{"parent":"root","lineStyle":{"lineColor":"#E1BEE7","lineWidth":"2"},"children":[{"parent":"223789477ed0","children":[],"id":"ebc1eec37f91","title":"&lt;MyContext.Provider&nbsp;value={/*&nbsp;某个值&nbsp;*/}&gt;"},{"parent":"223789477ed0","note":"","children":[],"id":"7b36d7180f38","title":"每个&nbsp;Context&nbsp;对象都会返回一个&nbsp;Provider&nbsp;React&nbsp;组件，它允许消费组件订阅&nbsp;context&nbsp;的变化","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"223789477ed0","note":"","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"roundBroken","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"a16c6e5bcc2b","title":"Provider&nbsp;接收一个&nbsp;value&nbsp;属性，传递给消费组件。<br>一个&nbsp;Provider&nbsp;可以和多个消费组件有对应关系。多个&nbsp;Provider&nbsp;也可以嵌套使用，里层的会覆盖外层的数据<br>","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]},{"parent":"223789477ed0","note":"","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[],"style":{"lineStype":{"lineType":"roundBroken","lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"092bfe8c5167","title":"当&nbsp;Provider&nbsp;的&nbsp;value&nbsp;值发生变化时，它内部的所有消费组件都会重新渲染。Provider&nbsp;及其内部&nbsp;consumer&nbsp;组件都不受制于&nbsp;shouldComponentUpdate&nbsp;函数，因此当&nbsp;consumer&nbsp;组件在其祖先组件退出更新的情况下也能更新","icons":[{"color":"rgb(113, 203, 45)","name":"priority","index":"2","text":"&#xe62a"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#0D47A1","textAlign":"left","font-weight":"bold","font-size":13,"font-style":"normal","border-radius":"5px","background-color":"#E1BEE7","lineStype":{"lineColor":"#E1BEE7","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#E1BEE7","lineWidth":"2"},"font-family":"微软雅黑","border-width":0,"border-style":"solid"},"id":"223789477ed0","title":"Context.Provider<br>"},{"parent":"root","lineStyle":{"lineColor":"#FFCDD2","lineWidth":"2"},"children":[{"parent":"21f97824d675","note":"class MyClass extends React.Component {\n  componentDidMount() {\n    let value = this.context;\n    /* 在组件挂载完成后，使用 MyContext 组件的值来执行一些有副作用的操作 */\n  }\n  componentDidUpdate() {\n    let value = this.context;\n    /* ... */\n  }\n  componentWillUnmount() {\n    let value = this.context;\n    /* ... */\n  }\n  render() {\n    let value = this.context;\n    /* 基于 MyContext 组件的值进行渲染 */\n  }\n}\nMyClass.contextType = MyContext;","children":[],"id":"40362a812f37","title":"挂载在&nbsp;class&nbsp;上的&nbsp;contextType&nbsp;属性会被重赋值为一个由&nbsp;React.createContext()&nbsp;创建的&nbsp;Context&nbsp;对象。这能让你使用&nbsp;this.context&nbsp;来消费最近&nbsp;Context&nbsp;上的那个值。你可以在任何生命周期中访问到它，包括&nbsp;render&nbsp;函数中","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"21f97824d675","lineStyle":{"lineColor":"#555","lineWidth":1},"children":[{"parent":"05f4325be7ec","children":[],"id":"6d01a377a8ef","title":"你只通过该&nbsp;API&nbsp;订阅单一&nbsp;context。如果你想订阅多个，阅读使用多个&nbsp;Context&nbsp;章节"},{"parent":"05f4325be7ec","children":[],"id":"4d66f1c30673","title":"如果你正在使用实验性的&nbsp;public&nbsp;class&nbsp;fields&nbsp;语法，你可以使用&nbsp;static&nbsp;这个类属性来初始化你的&nbsp;contextType"}],"style":{"lineStype":{"lineColor":"#555","lineWidth":1},"padding":"2px 8px 2px 8px","color":"#666","lineStyle":{"lineColor":"#555","lineWidth":1},"textAlign":"left","font-weight":"normal","font-size":"13px","font-family":"微软雅黑","bold":false,"font-style":"normal","italic":false},"id":"05f4325be7ec","title":"注意：<br>","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#0D47A1","textAlign":"left","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","font-style":"normal","border-radius":"5px","background-color":"#FFCDD2","lineStype":{"lineColor":"#FFCDD2","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#FFCDD2","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"font-family":"微软雅黑","border-width":"0px","border-style":"none"},"id":"21f97824d675","title":"Class.contextType<br>"},{"parent":"root","lineStyle":{"lineColor":"#C8E6C9","lineWidth":"2"},"children":[{"parent":"50a78d122f0e","children":[],"id":"1ecdfe94db76","title":"&lt;MyContext.Consumer&gt;<br>&nbsp;&nbsp;{value&nbsp;=&gt;&nbsp;/*&nbsp;基于&nbsp;context&nbsp;值进行渲染*/}<br>&lt;/MyContext.Consumer&gt;"},{"parent":"50a78d122f0e","note":"","children":[],"id":"ceb62dc3354a","title":"这里，React&nbsp;组件也可以订阅到&nbsp;context&nbsp;变更。这能让你在函数式组件中完成订阅&nbsp;context","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"50a78d122f0e","note":"","children":[],"id":"123e6b15f806","title":"这需要函数作为子元素（function&nbsp;as&nbsp;a&nbsp;child）这种做法。这个函数接收当前的&nbsp;context&nbsp;值，返回一个&nbsp;React&nbsp;节点。传递给函数的&nbsp;value&nbsp;值等同于往上组件树离这个&nbsp;context&nbsp;最近的&nbsp;Provider&nbsp;提供的&nbsp;value&nbsp;值。如果没有对应的&nbsp;Provider，value&nbsp;参数等同于传递给&nbsp;createContext()&nbsp;的&nbsp;defaultValue<br>","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]}],"boundaries":[{"boundary":true,"parent":"50a78d122f0e","boundRank":1,"children":[],"pos":{"miny":10024,"minx":10294,"maxY":10100,"maxX":10574},"range":"0,0","style":{"lineType":"1","dasharray":"6,3","lineColor":"transparent","opacity":"0.1","fill":"#63abf7","lineWidth":"1"},"id":"c47aefea348e","title":"外框"}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#0D47A1","textAlign":"left","font-weight":"bold","font-size":13,"border-color":"rgb(255, 255, 255)","font-style":"normal","border-radius":"5px","background-color":"#C8E6C9","lineStype":{"lineColor":"#F57F17","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#C8E6C9","randomLineColor":"rgb(153,204,255)","lineWidth":"2"},"font-family":"微软雅黑","border-width":"0px","border-style":"none"},"id":"50a78d122f0e","title":"Context.Consumer<br>"},{"parent":"root","lineStyle":{"lineColor":"#FFE0B2","lineWidth":"2"},"children":[{"parent":"072ee8e22b0c","note":"","children":[],"id":"5e5f1d695f41","title":"context&nbsp;对象接受一个名为&nbsp;displayName&nbsp;的&nbsp;property，类型为字符串。React&nbsp;DevTools&nbsp;使用该字符串来确定&nbsp;context&nbsp;要显示的内容","icons":[{"color":"rgb(191, 30, 27)","name":"priority","index":"0","text":"&#xe67a"}]},{"parent":"072ee8e22b0c","children":[{"parent":"3b8aabfdccc7","note":"const MyContext = React.createContext(/* some value */);\nMyContext.displayName = &#39;MyDisplayName&#39;;\n\n&lt;MyContext.Provider&gt; // &quot;MyDisplayName.Provider&quot; 在 DevTools 中\n&lt;MyContext.Consumer&gt; // &quot;MyDisplayName.Consumer&quot; 在 DevTools 中","children":[],"id":"99e6a15190f2","title":"代码"}],"id":"3b8aabfdccc7","title":"示例，下述组件在&nbsp;DevTools&nbsp;中将显示为&nbsp;MyDisplayName<br>","icons":[{"color":"rgb(99, 171, 247)","name":"priority","index":"1","text":"&#xe625"}]}],"style":{"padding":"8px 10px 8px 10px","backgroundColor":"#2196F3","color":"#0D47A1","textAlign":"left","font-weight":"bold","font-size":13,"font-style":"normal","border-radius":"5px","background-color":"#FFE0B2","lineStype":{"lineColor":"#FFE0B2","lineWidth":"2"},"box-shadow":"1px 2px 6px #aaa","lineStyle":{"lineColor":"#FFE0B2","lineWidth":"2"},"font-family":"微软雅黑","border-width":0,"border-style":"solid"},"id":"072ee8e22b0c","title":"Context.displayName<br>"}],"root":true,"theme":"customise_7fd055efa78b","style":{"background-color":"rgb(255, 83, 92)","border-radius":"6px","color":"rgb(255, 255, 255)","font-weight":"bold","border-color":"rgb(255, 255, 255)","border-width":"0px","border-style":"none"},"id":"root","title":"Context&nbsp;API","icons":[],"structure":"mind_free"}},"meta":{"exportTime":"2022-04-02 17:10:49","member":"60cca488e0b34d55bbf2954f","diagramInfo":{"creator":"60cca488e0b34d55bbf2954f","created":"2022-04-02 16:56:41","modified":"2022-04-02 17:10:38","title":"3.3.2Context API","category":"mind_free"},"id":"62480fc91efad40756de8ef9","type":"ProcessOn Schema File","version":"1.0"}}